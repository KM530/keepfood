智能食物保鲜管家 - API接口文档
版本: 2.0
基地址: /api

1. 认证模块 (Auth)

1.2 用户注册
使用邮箱和密码完成新用户注册。

接口地址: /auth/register

方法: POST

需要登录: 否

请求参数:

{
  "email": "13800138000@163.com",
  "password": "hashed_password_string",
  "nickname": "小明"
}

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "token": "jwt_token_string",
    "user": {
      "id": "123456",
      "nickname": "小明",
      "avatarUrl": null
    }
  },
  "message": "注册成功"
}

1.3 用户登录
用户使用账号密码进行登录。

接口地址: /auth/login

方法: POST

需要登录: 否

请求参数:

{
  "account": "13800138000@163.com", // 是邮箱
  "password": "hashed_password_string"
}

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "token": "jwt_token_string",
    "user": {
      "id": "123456",
      "nickname": "小明",
      "avatarUrl": "http://example.com/avatar.jpg"
    }
  },
  "message": "登录成功"
}

1.4 用户退出
清除服务端的登录状态。

接口地址: /auth/logout

方法: POST

需要登录: 是

请求参数: (无)

响应类型: json

返回值:

{
  "code": 0,
  "body": null,
  "message": "退出成功"
}

2. 用户模块 (Users)
2.1 获取当前用户信息
获取当前登录用户的详细信息。

接口地址: /users/me

方法: GET

需要登录: 是

请求参数: (无)

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "id": "123456",
    "nickname": "小明",
    "avatarUrl": "http://example.com/avatar.jpg",
    "email": "test@example.com"
  },
  "message": "成功"
}

2.2 更新当前用户信息
更新用户的昵称或头像。

接口地址: /users/me

方法: PUT

需要登录: 是

请求参数: (Content-Type: multipart/form-data)

nickname: "小明同学" (string, 可选)

avatar: (file, 可选, 头像图片文件)

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "nickname": "小明同学",
    "avatarUrl": "http://example.com/new_avatar.jpg"
  },
  "message": "更新成功"
}


3. 食物模块 (Foods)
3.1 获取食物列表
用于首页，分页获取用户的食物库存。

接口地址: /foods

方法: GET

需要登录: 是

请求参数 (Query String):

sortBy: "expiry_date" (string, 可选, 排序方式, 'expiry_date', 'created_at', 'category')

page: 1 (number, 可选, 页码)

limit: 20 (number, 可选, 每页数量)

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "items": [
      {
        "id": 1,
        "name": "牛奶",
        "imageUrl": "http://example.com/milk.jpg",
        "quantity": 2,
        "unit": "瓶",
        "expiryDate": "2025-08-05",
        "status": "expiring_soon" // normal, expiring_soon, expired
      }
    ],
    "total": 100,
    "page": 1,
    "limit": 20
  },
  "message": "成功"
}

3.2 新增食物
用户添加一个新的食物条目。

接口地址: /foods

方法: POST

需要登录: 是

请求参数 (Content-Type: multipart/form-data):

image: (file, 必填)

name: "牛奶" (string, 必填)

quantity: 1 (number, 必填)

unit: "盒" (string, 必填)

categoryId: 1 (number, 必填)

locationId: 1 (number, 可选)

productionDate: "2025-07-20" (string, 'YYYY-MM-DD', 可选)

shelfLifeValue: 15 (number, 可选)

shelfLifeUnit: "day" (string, 'day'/'month'/'year', 可选)

expiryDate: "2025-08-04" (string, 'YYYY-MM-DD', 可选)

ingredientsText: "生牛乳..." (string, 可选)

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "id": 101,
    "name": "牛奶",
    "caloriesKcal": 150,
    "energyOffsetInfo": "建议：步行 2.5 公里"
  },
  "message": "添加成功"
}

3.3 获取指定食物详情
查看单个食物的全部信息。

接口地址: /foods/{id}

方法: GET

需要登录: 是

请求参数 (Path):

id: 1 (number, 食物ID)

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "id": 1,
    "name": "牛奶",
    "imageUrls": ["http://example.com/milk.jpg"],
    "quantity": 2,
    "unit": "瓶",
    "category": { "id": 1, "name": "肉蛋奶" },
    "location": { "id": 1, "name": "冰箱冷藏" },
    "productionDate": "2025-07-20",
    "expiryDate": "2025-08-05",
    "ingredientsText": "生牛乳...",
    "harmfulIngredientsJson": ["阿斯巴甜"],
    "caloriesKcal": 300,
    "energyOffsetInfo": "建议：步行 5 公里"
  },
  "message": "成功"
}

3.4 更新指定食物详情
编辑已存在的食物信息。

接口地址: /foods/{id}

方法: PUT

需要登录: 是

请求参数: 类似 3.2 新增食物，但为 application/json 格式，且图片更新需要单独接口或form-data。

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "id": 1,
    "name": "进口牛奶"
  },
  "message": "更新成功"
}

3.5 删除食物
从库存中删除一个食物条目。

接口地址: /foods/{id}

方法: DELETE

需要登录: 是

请求参数 (Path):

id: 1 (number, 食物ID)

响应类型: json

返回值:

{
  "code": 0,
  "body": null,
  "message": "删除成功"
}

3.6 消耗食物
减少食物的库存数量。

接口地址: /foods/{id}/consume

方法: POST

需要登录: 是

请求参数 (Path & Body):

id: 1 (number, 食物ID)

Body: { "quantity": 1 }

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "id": 1,
    "remainingQuantity": 1
  },
  "message": "消耗成功"
}

4. 分类与位置模块
4.1 获取分类列表
获取所有系统预置和用户自定义的分类。

接口地址: /categories

方法: GET

需要登录: 是

请求参数: (无)

响应类型: json

返回值:

{
  "code": 0,
  "body": [
    { "id": 1, "name": "蔬菜水果", "isSystem": true },
    { "id": 2, "name": "肉蛋奶", "isSystem": true },
    { "id": 15, "name": "我的烘焙", "isSystem": false }
  ],
  "message": "成功"
}

4.2 新增分类
用户添加自定义分类。

接口地址: /categories

方法: POST

需要登录: 是

请求参数: { "name": "宝宝辅食" }

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "id": 16,
    "name": "宝宝辅食",
    "isSystem": false
  },
  "message": "创建成功"
}

4.3 获取存放位置列表
获取用户所有自定义的存放位置。

接口地址: /locations

方法: GET

需要登录: 是

请求参数: (无)

响应类型: json

返回值:

{
  "code": 0,
  "body": [
    { "id": 1, "name": "冰箱冷藏" },
    { "id": 2, "name": "厨房储物柜" }
  ],
  "message": "成功"
}

5. 购物清单模块
5.1 获取购物清单
查看完整的购物清单。

接口地址: /shopping-list

方法: GET

需要登录: 是

请求参数: (无)

响应类型: json

返回值:

{
  "code": 0,
  "body": [
    { "id": 1, "itemName": "牛奶", "isChecked": false },
    { "id": 2, "itemName": "面包", "isChecked": true }
  ],
  "message": "成功"
}

5.2 添加商品到清单
手动或从食物详情页添加商品。

接口地址: /shopping-list/items

方法: POST

需要登录: 是

请求参数:

{
  "itemName": "鸡蛋",
  "fromFoodId": null // or number, e.g., 5
}

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "id": 3,
    "itemName": "鸡蛋",
    "isChecked": false
  },
  "message": "添加成功"
}

5.3 批量更新/删除清单商品
用于编辑模式下的勾选和删除操作。

接口地址: /shopping-list/items

方法: PATCH

需要登录: 是

请求参数:

{
  "updates": [ // 更新状态
    { "id": 1, "isChecked": true }
  ],
  "deletions": [2] // 要删除的ID列表
}

响应类型: json

返回值:

{
  "code": 0,
  "body": null,
  "message": "操作成功"
}

6. AI模块
6.1 识别配料表图片
上传食物包装图片，AI进行OCR识别。

接口地址: /ai/ocr-ingredients

方法: POST

需要登录: 是

请求参数 (Content-Type: multipart/form-data):

image: (file, 必填)

响应类型: json

返回值:

{
  "code": 0,
  "body": {
    "ingredientsText": "生牛乳，水，白砂糖，食品添加剂（阿斯巴甜）...",
    "harmfulIngredients": ["阿斯巴甜"]
  },
  "message": "识别成功"
}

6.2 生成菜谱
根据用户选择的临期食材，AI生成菜谱。

接口地址: /ai/generate-recipes

方法: POST

需要登录: 是

请求参数:

{
  "foodIds": [1, 5, 12]
}

响应类型: json

返回值:

{
  "code": 0,
  "body": [
    {
      "recipeName": "牛奶鸡蛋羹",
      "videoUrl": "http://example.com/recipe1.mp4",
      "usedIngredients": ["牛奶", "鸡蛋"],
      "otherIngredients": ["糖", "水"]
    }
  ],
  "message": "菜谱生成成功"
}

7. 系统与通知模块
7.1 注册设备推送令牌
APP启动时调用，用于接收推送通知。

接口地址: /push/register-token

方法: POST

需要登录: 是

请求参数:

{
  "deviceToken": "apns_or_fcm_token_string",
  "deviceType": "ios" // 'ios' or 'android'
}

响应类型: json

返回值:

{
  "code": 0,
  "body": null,
  "message": "令牌注册成功"
}

7.2 更新通知设置
用户自定义通知偏好。

接口地址: /users/me/settings

方法: PUT

需要登录: 是

请求参数:

{
  "enableExpiryPush": true,
  "pushLeadDays": 3, // 提前几天提醒
  "pushTime": "09:00" // 提醒时间
}

响应类型: json

返回值:

{
  "code": 0,
  "body": null,
  "message": "设置已保存"
}
